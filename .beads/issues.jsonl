{"id":"higher-peak-00p","title":"Implement sg disable/enable escape hatch","description":"Why: User needs to bypass superego if it malfunctions. Done when: sg disable sets flag, hooks check flag and skip, SUPEREGO_DISABLED env var also works.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T18:15:31.442812+01:00","updated_at":"2025-12-11T18:15:31.442812+01:00","dependencies":[{"issue_id":"higher-peak-00p","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:17:21.244976+01:00","created_by":"drazen"}]}
{"id":"higher-peak-0m1","title":"Implement sg evaluate command (UserPromptSubmit)","description":"Why: Infer phase from user message, cache to state.json. Done when: Reads transcript + new user message, calls superego LLM, writes phase to .superego/state.json. Called by UserPromptSubmit hook.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:08:44.738794+01:00","updated_at":"2025-12-11T18:08:44.738794+01:00","dependencies":[{"issue_id":"higher-peak-0m1","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:09:27.482082+01:00","created_by":"drazen"},{"issue_id":"higher-peak-0m1","depends_on_id":"higher-peak-1sa","type":"blocks","created_at":"2025-12-11T18:09:32.613686+01:00","created_by":"drazen"},{"issue_id":"higher-peak-0m1","depends_on_id":"higher-peak-465","type":"blocks","created_at":"2025-12-11T18:09:37.759647+01:00","created_by":"drazen"},{"issue_id":"higher-peak-0m1","depends_on_id":"higher-peak-uws","type":"blocks","created_at":"2025-12-11T18:09:42.89031+01:00","created_by":"drazen"},{"issue_id":"higher-peak-0m1","depends_on_id":"higher-peak-oin","type":"blocks","created_at":"2025-12-11T18:17:11.810764+01:00","created_by":"drazen"},{"issue_id":"higher-peak-0m1","depends_on_id":"higher-peak-ya8","type":"blocks","created_at":"2025-12-11T18:17:36.708414+01:00","created_by":"drazen"}]}
{"id":"higher-peak-1sa","title":"Implement Claude CLI invocation from Rust","description":"Why: Core evaluation engine - call claude CLI with context. Done when: Can invoke claude CLI, pass system prompt + user message, parse JSON response (handle prose around JSON robustly), handle errors/timeouts. NOTE: Verify correct CLI flags, may need adaptation.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T17:56:34.307856+01:00","updated_at":"2025-12-11T18:36:57.422778+01:00","dependencies":[{"issue_id":"higher-peak-1sa","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T17:57:20.712011+01:00","created_by":"drazen"}]}
{"id":"higher-peak-24g","title":"Implement model selection config","description":"Why: Users may want faster/cheaper model for superego. Done when: .superego/config.yaml supports model setting, defaults to Claude Code default, sg evaluate uses configured model.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T18:35:12.742893+01:00","updated_at":"2025-12-11T18:35:12.742893+01:00","dependencies":[{"issue_id":"higher-peak-24g","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:36:30.678605+01:00","created_by":"drazen"}]}
{"id":"higher-peak-33t","title":"Implement state evaluation heuristics","description":"Why: Optional fast-path before LLM call. Done when: Quick checks (action count, explicit 'wait' phrases) can skip LLM call when clearly fine. OPTIONAL - LLM handles this if not implemented.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-11T17:47:25.787841+01:00","updated_at":"2025-12-11T17:58:51.755062+01:00","dependencies":[{"issue_id":"higher-peak-33t","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T17:50:23.309776+01:00","created_by":"drazen"}]}
{"id":"higher-peak-419","title":"Implement sg override command","description":"Why: Claude calls this after user approves override. Done when: Writes override_granted decision with reason, allows blocked action to proceed.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T17:46:54.160258+01:00","updated_at":"2025-12-11T17:46:54.160258+01:00","dependencies":[{"issue_id":"higher-peak-419","depends_on_id":"higher-peak-9eo","type":"blocks","created_at":"2025-12-11T17:50:56.740762+01:00","created_by":"drazen"},{"issue_id":"higher-peak-419","depends_on_id":"higher-peak-cdz","type":"blocks","created_at":"2025-12-11T18:17:41.859111+01:00","created_by":"drazen"}]}
{"id":"higher-peak-465","title":"Implement superego session management","description":"Why: Persist superego's own context across checks. Done when: Session stored in .superego/session/, --continue flag used to maintain context, session survives across main Claude sessions.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T17:56:47.313652+01:00","updated_at":"2025-12-11T17:56:47.313652+01:00","dependencies":[{"issue_id":"higher-peak-465","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T17:57:25.852403+01:00","created_by":"drazen"}]}
{"id":"higher-peak-4ik","title":"Implement sg history command","description":"Why: Context recovery - Claude can query past decisions. Done when: Reads .superego/decisions/*, returns chronological list with optional limit.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T17:47:02.982551+01:00","updated_at":"2025-12-11T17:47:02.982551+01:00","dependencies":[{"issue_id":"higher-peak-4ik","depends_on_id":"higher-peak-9eo","type":"blocks","created_at":"2025-12-11T17:51:01.868753+01:00","created_by":"drazen"}]}
{"id":"higher-peak-4mi","title":"Support nested .superego/ discovery (future)","description":"Why: User might have project/.superego/ and project/subdir/.superego/. Future: Implement discovery logic like beads does - walk up to find nearest .superego/.","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-11T18:36:00.391634+01:00","updated_at":"2025-12-11T18:36:00.391634+01:00"}
{"id":"higher-peak-6pg","title":"Verify Claude CLI invocation syntax","description":"Why: Need correct flags for non-interactive Claude calls. Done when: Tested claude --print (or correct flag), documented in ARCHITECTURE.md, handles session continuation.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:35:00.923189+01:00","updated_at":"2025-12-11T18:35:00.923189+01:00","dependencies":[{"issue_id":"higher-peak-6pg","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:36:25.541736+01:00","created_by":"drazen"}]}
{"id":"higher-peak-6wt","title":"Implement sg reset command","description":"Why: Recovery from corrupted state. Done when: Clears state.json, optionally clears session/, preserves decisions/ journal.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T18:23:36.991851+01:00","updated_at":"2025-12-11T18:23:36.991851+01:00","dependencies":[{"issue_id":"higher-peak-6wt","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:24:37.159522+01:00","created_by":"drazen"}]}
{"id":"higher-peak-7sh","title":"Create UserPromptSubmit hook","description":"Why: Trigger phase evaluation on every user message. Done when: Hook calls sg evaluate with transcript path, runs before Claude responds.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:08:56.264172+01:00","updated_at":"2025-12-11T18:08:56.264172+01:00","dependencies":[{"issue_id":"higher-peak-7sh","depends_on_id":"higher-peak-0m1","type":"blocks","created_at":"2025-12-11T18:09:48.02664+01:00","created_by":"drazen"}]}
{"id":"higher-peak-88l","title":"Implement sg acknowledge command","description":"Why: Claude calls this to accept feedback and clear the queue. Done when: Writes feedback_accepted decision, clears pending state.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T17:46:45.676276+01:00","updated_at":"2025-12-11T17:46:45.676276+01:00","dependencies":[{"issue_id":"higher-peak-88l","depends_on_id":"higher-peak-9eo","type":"blocks","created_at":"2025-12-11T17:50:51.593484+01:00","created_by":"drazen"}]}
{"id":"higher-peak-8lw","title":"Implement sg init command","description":"Why: Users need to initialize .superego/ in their project. Done when: Creates .superego/ dir, writes default prompt.md (from embedded default), empty state.json (phase: exploring), decisions/ folder, config.yaml with defaults.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:23:04.477281+01:00","updated_at":"2025-12-11T18:37:09.988488+01:00","dependencies":[{"issue_id":"higher-peak-8lw","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:24:26.886158+01:00","created_by":"drazen"}]}
{"id":"higher-peak-9eo","title":"Implement decision journal (read/write YAML)","description":"Why: Persist decisions for context recovery and audit trail. Done when: Can write decision records to .superego/decisions/, read them back, session_id in records not paths.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T17:46:18.514268+01:00","updated_at":"2025-12-11T17:46:18.514268+01:00","dependencies":[{"issue_id":"higher-peak-9eo","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T17:50:18.161186+01:00","created_by":"drazen"}]}
{"id":"higher-peak-9ty","title":"Scaffold Rust CLI project with clap","description":"Why: Foundation for all sg commands. Done when: cargo new + clap dependency + basic sg --help works.","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-11T17:46:00.664042+01:00","updated_at":"2025-12-11T17:46:00.664042+01:00"}
{"id":"higher-peak-a6m","title":"Investigate session_id extraction from transcript path","description":"Why: Need to know where session_id comes from for decision records. Done when: Documented how to extract session_id (from filename? hook input?), implemented in CLI.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:34:37.502436+01:00","updated_at":"2025-12-11T18:34:37.502436+01:00","dependencies":[{"issue_id":"higher-peak-a6m","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:36:15.260076+01:00","created_by":"drazen"}]}
{"id":"higher-peak-anu","title":"Implement tool classification (read vs write)","description":"Why: Only gate write tools, skip reads for speed. Done when: Classifies tools as read (Glob,Grep,Read,LS,WebFetch,WebSearch) or write (Edit,Write,Bash,Task,NotebookEdit). PreToolUse hook uses this to skip checks on reads.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:09:04.632425+01:00","updated_at":"2025-12-11T18:09:04.632425+01:00","dependencies":[{"issue_id":"higher-peak-anu","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:09:53.148892+01:00","created_by":"drazen"}]}
{"id":"higher-peak-awt","title":"Implement recursion prevention","description":"Why: Superego's Claude session must not trigger hooks that call superego. Done when: Hooks detect .superego/ in transcript path and skip, or use session ID filtering.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:14:38.247985+01:00","updated_at":"2025-12-11T18:14:38.247985+01:00","dependencies":[{"issue_id":"higher-peak-awt","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:16:51.248466+01:00","created_by":"drazen"}]}
{"id":"higher-peak-cdz","title":"Define override scope and duration","description":"Why: When user overrides, unclear how long it lasts. Done when: Decided and implemented - options: single action, rest of session, until phase changes. Probably: override allows one blocked action, then re-evaluates.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T18:16:28.962909+01:00","updated_at":"2025-12-11T18:18:56.131616+01:00","closed_at":"2025-12-11T18:18:56.131616+01:00","close_reason":"Decision: Override allows single action only, then re-evaluates on next write tool. Safest approach - forces explicit re-confirmation."}
{"id":"higher-peak-ddl","title":"Implement PreCompact hook for state preservation","description":"Why: When Claude compacts context, transcript is truncated. Superego must update its tracking before compaction. Done when: PreCompact hook calls sg precompact, which reads full transcript and writes summary decision to journal capturing current understanding (phase, scope, key decisions).","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:34:21.8048+01:00","updated_at":"2025-12-11T18:39:06.682411+01:00","dependencies":[{"issue_id":"higher-peak-ddl","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:36:10.111562+01:00","created_by":"drazen"}]}
{"id":"higher-peak-e89","title":"Implement sg context-inject command","description":"Why: SessionStart hook needs to inject superego context into Claude. Done when: Outputs behavioral contract + recent decisions summary as additionalContext for Claude.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T18:23:20.258193+01:00","updated_at":"2025-12-11T18:23:20.258193+01:00","dependencies":[{"issue_id":"higher-peak-e89","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:24:32.001237+01:00","created_by":"drazen"},{"issue_id":"higher-peak-e89","depends_on_id":"higher-peak-4ik","type":"blocks","created_at":"2025-12-11T18:24:52.602841+01:00","created_by":"drazen"}]}
{"id":"higher-peak-g1h","title":"Implement override state tracking in sg check","description":"Why: sg check needs to know if override is pending. Done when: sg override sets pending_override in state.json, sg check allows one action then clears it.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:23:56.178839+01:00","updated_at":"2025-12-11T18:23:56.178839+01:00","dependencies":[{"issue_id":"higher-peak-g1h","depends_on_id":"higher-peak-v2i","type":"blocks","created_at":"2025-12-11T18:24:42.314744+01:00","created_by":"drazen"}]}
{"id":"higher-peak-ggj","title":"Design superego system prompt","description":"Why: Defines superego's personality and evaluation criteria. Done when: prompt.md template exists, covers: phase detection, unknown tracking, JSON output format. IMPORTANT: If first message is ambiguous (e.g. 'fix the bug'), superego should indicate opportunity for Claude to clarify scope before proceeding.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T17:56:15.728032+01:00","updated_at":"2025-12-11T18:37:25.450116+01:00","dependencies":[{"issue_id":"higher-peak-ggj","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T17:57:15.575755+01:00","created_by":"drazen"}]}
{"id":"higher-peak-gmx","title":"Create SessionStart hook for context injection","description":"Why: Inject superego behavioral contract into Claude's context. Done when: Hook returns additionalContext with obligations, resumed session shows decision summary.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T17:47:44.975752+01:00","updated_at":"2025-12-11T17:47:44.975752+01:00","dependencies":[{"issue_id":"higher-peak-gmx","depends_on_id":"higher-peak-4ik","type":"blocks","created_at":"2025-12-11T17:51:15.43955+01:00","created_by":"drazen"},{"issue_id":"higher-peak-gmx","depends_on_id":"higher-peak-e89","type":"blocks","created_at":"2025-12-11T18:24:57.760663+01:00","created_by":"drazen"}]}
{"id":"higher-peak-iqj","title":"Setup cargo packaging and installation","description":"Why: Users need to install sg CLI. Done when: cargo install works, Cargo.toml has proper metadata, README has install instructions.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T18:24:11.296693+01:00","updated_at":"2025-12-11T18:24:11.296693+01:00","dependencies":[{"issue_id":"higher-peak-iqj","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:24:47.463528+01:00","created_by":"drazen"}]}
{"id":"higher-peak-khw","title":"Investigate cost/usage metadata from Claude calls","description":"Why: Users should see superego's LLM usage. Done when: Investigated if Claude CLI exposes token counts/cost, implemented usage tracking if available.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-11T18:35:39.078714+01:00","updated_at":"2025-12-11T18:35:39.078714+01:00","dependencies":[{"issue_id":"higher-peak-khw","depends_on_id":"higher-peak-1sa","type":"blocks","created_at":"2025-12-11T18:36:35.802467+01:00","created_by":"drazen"}]}
{"id":"higher-peak-lsm","title":"Document Claude behavioral contract","description":"Why: Claude needs clear instructions on how to behave when blocked. Done when: Markdown doc specifies: surface conflicts to user, present options, call acknowledge/override appropriately.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T17:47:57.248247+01:00","updated_at":"2025-12-11T17:47:57.248247+01:00"}
{"id":"higher-peak-o7e","title":"Define context window strategy for LLM evaluation","description":"Why: Need to decide how much transcript to send to superego LLM. Done when: Strategy documented and implemented - options: last N messages, last N tokens, summary + recent, sliding window.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:16:13.526379+01:00","updated_at":"2025-12-11T18:16:13.526379+01:00","dependencies":[{"issue_id":"higher-peak-o7e","depends_on_id":"higher-peak-uws","type":"blocks","created_at":"2025-12-11T18:16:56.40598+01:00","created_by":"drazen"}]}
{"id":"higher-peak-oin","title":"Implement failure handling for sg evaluate","description":"Why: LLM calls can fail/timeout. Done when: Timeout handling, fallback to safe default (EXPLORING), error logging, user notification on repeated failures.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T18:15:15.971888+01:00","updated_at":"2025-12-11T18:15:15.971888+01:00","dependencies":[{"issue_id":"higher-peak-oin","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:18:07.687705+01:00","created_by":"drazen"}]}
{"id":"higher-peak-ov5","title":"End-to-end integration test","description":"Why: Verify full flow works. Done when: Test covers: hook blocks action → Claude surfaces conflict → user overrides → hook allows retry.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-11T17:48:10.741668+01:00","updated_at":"2025-12-11T17:48:10.741668+01:00","dependencies":[{"issue_id":"higher-peak-ov5","depends_on_id":"higher-peak-yr1","type":"blocks","created_at":"2025-12-11T17:51:20.617469+01:00","created_by":"drazen"},{"issue_id":"higher-peak-ov5","depends_on_id":"higher-peak-gmx","type":"blocks","created_at":"2025-12-11T17:51:25.719328+01:00","created_by":"drazen"},{"issue_id":"higher-peak-ov5","depends_on_id":"higher-peak-7sh","type":"blocks","created_at":"2025-12-11T18:11:00.629461+01:00","created_by":"drazen"}]}
{"id":"higher-peak-s0n","title":"Implement detailed audit trail logging","description":"Why: Need visibility into superego decisions for debugging. Done when: Every evaluate/check/override writes to .superego/audit.log with timestamp, input, decision, reason.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T18:34:50.984317+01:00","updated_at":"2025-12-11T18:34:50.984317+01:00","dependencies":[{"issue_id":"higher-peak-s0n","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:36:20.402384+01:00","created_by":"drazen"}]}
{"id":"higher-peak-uws","title":"Implement transcript JSONL reader","description":"Why: Superego needs to read Claude Code conversation history. Done when: Can parse transcript_path JSONL, extract messages with roles/content.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T17:46:10.227196+01:00","updated_at":"2025-12-11T17:46:10.227196+01:00","dependencies":[{"issue_id":"higher-peak-uws","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T17:50:13.003014+01:00","created_by":"drazen"}]}
{"id":"higher-peak-v2i","title":"Implement sg check command","description":"Why: Fast gate for write tools. Done when: Reads .superego/state.json (cached phase), returns allow/block based on phase vs tool type. NO LLM call - just reads cached state from evaluate.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T17:46:26.701874+01:00","updated_at":"2025-12-11T18:10:14.517527+01:00","dependencies":[{"issue_id":"higher-peak-v2i","depends_on_id":"higher-peak-9eo","type":"blocks","created_at":"2025-12-11T17:50:36.82027+01:00","created_by":"drazen"},{"issue_id":"higher-peak-v2i","depends_on_id":"higher-peak-anu","type":"blocks","created_at":"2025-12-11T18:10:41.366504+01:00","created_by":"drazen"}]}
{"id":"higher-peak-ya8","title":"Handle cold start (first evaluation)","description":"Why: First sg evaluate has no prior context. Done when: Detects missing state.json, primes superego with project summary from decision journal, defaults to EXPLORING phase.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T18:15:47.219+01:00","updated_at":"2025-12-11T18:15:47.219+01:00","dependencies":[{"issue_id":"higher-peak-ya8","depends_on_id":"higher-peak-9ty","type":"blocks","created_at":"2025-12-11T18:18:12.820842+01:00","created_by":"drazen"}]}
{"id":"higher-peak-yr1","title":"Create PreToolUse hook script","description":"Why: Gate Claude actions via hook. Done when: Hook reads stdin JSON, calls sg check, returns permissionDecision deny/allow with reason.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-11T17:47:34.398443+01:00","updated_at":"2025-12-11T17:47:34.398443+01:00","dependencies":[{"issue_id":"higher-peak-yr1","depends_on_id":"higher-peak-v2i","type":"blocks","created_at":"2025-12-11T17:51:10.287715+01:00","created_by":"drazen"},{"issue_id":"higher-peak-yr1","depends_on_id":"higher-peak-anu","type":"blocks","created_at":"2025-12-11T18:09:58.318623+01:00","created_by":"drazen"}]}
